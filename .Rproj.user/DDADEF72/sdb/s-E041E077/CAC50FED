{
    "contents" : "---\ntitle: \"Reproducible Research: Peer Assessment 1\"\noutput: \n  html_document:\n    keep_md: true\n---\n```{r setoptions, echo=FALSE}\nopts_chunk$set(fig.width=10)\n```\n\n\n## Loading and preprocessing the data\nLoad the data.\n```{r}\nunzip(\"activity.zip\")\ndata = read.csv(\"activity.csv\")\n```\n\nAnd preview the data\n```{r}\ndim(data)\nhead(data)\n```\n\n## What is mean total number of steps taken per day?\nCalculate steps per day, ignore NA values.\n```{r}\nsteps.per.day = aggregate(data$steps, by=list(data$date),sum, na.rm=T)\ncolnames(steps.per.day) = c(\"date\", \"steps\")\n```\n\nDo hist plot.\n```{r}\nhist(steps.per.day$steps, breaks=10)\n```\n\nCalculate mean and median\n```{r}\nc(mean=mean(steps.per.day$steps), median=median(steps.per.day$steps))\n```\n\nWe can see that the mean/median steps per day is about 10,000.\n\n## What is the average daily activity pattern?\nCalcuate average steps on each interval\n```{r}\nsteps.on.interval = aggregate(data$steps, by=list(data$interval), mean, na.rm=T)\ncolnames(steps.on.interval) = c('interval', 'steps')\n```\nPlot steps along time\n```{r fig.width=10}\nplot(steps.on.interval, type=\"l\", xlab=\"time\", ylab=\"average steps /5min\", xaxt=\"n\")\naxis(1, at=0:24*100, labels= paste(0:24, \":00\", sep=\"\"))\n```\n\nWe can see that there are several peaks on the plot, the highest is at 8~9 o'clock.\nThe 5minute with the most average steps is\n```{r}\nsteps.on.interval[order(steps.on.interval$steps, decreasing=T)[1],]\n```\n\n\n## Imputing missing values\n\nThe numbers of records with NAs are\n```{r}\nsum(!complete.cases(data))\n```\n\nWe will fill these NAs with the mean steps on the time interval on average,\nand generated a new dataset named data.fillna\n```{r}\ndata.fillna = data\nfill.data = setNames(steps.on.interval$steps, as.character(steps.on.interval$interval))\nna.idx = is.na(data$steps)\ndata.fillna[na.idx, 'steps'] = fill.data[as.character(data[na.idx, 'interval'])]\nhead(data.fillna)\n```\n\nRecalculate steps per day\n```{r}\nattach(data.fillna)\nsteps.per.day.fillna = aggregate(steps, by=list(date),sum, na.rm=T)\ncolnames(steps.per.day.fillna) = c(\"date\", \"steps\")\nhist(steps.per.day.fillna$steps, breaks=10)\nc(mean=mean(steps.per.day.fillna$steps), \n  median=median(steps.per.day.fillna$steps))\ndetach(data.fillna)\n```\n\nAfter filling the missing data, we can see the peak of the histgram is more sharp,\nand the days with very small step numbers is decreased. These small step numbers \nmay induced by missing of data. Filling the missing data also makes the mean and\nmedian of daily steps become larger, as expected.\n\n\n## Are there differences in activity patterns between weekdays and weekends?\n\nGet patterns on weekdays and weekends, respectively.\n```{r }\nis.weekends = weekdays(as.Date(data$date)) %in% c(\"Saturday\", \"Sunday\")\npattern.weekdays = aggregate(data[!is.weekends,]$steps, \n                             by=list(data[!is.weekends,]$interval), mean, na.rm=T)\npattern.weekends = aggregate(data[is.weekends,]$steps, \n                             by=list(data[is.weekends,]$interval), mean, na.rm=T)\n```\n\nPlot and compare the pattern.\n```{r fig.height=8, }\npar(mfrow=c(2,1), oma=c(5,4,0,0), mar=c(0,0,1,1))\nplot(pattern.weekdays, type=\"l\", xlab=\"\", ylab=\"\", xaxt=\"n\")\naxis(1, at=0:24*100, labels= F)\nmtext(\"pattern in weekdays\", 3, -1)\nplot(pattern.weekends, type=\"l\", xlab=\"\", ylab=\"\", xaxt=\"n\")\nmtext(\"pattern in weekends\", 3, -1)\naxis(1, at=0:24*100, labels= paste(0:24, \":00\", sep=\"\"))\ntitle(xlab=\"time\", ylab=\"number of steps\", outer=T, cex.lab=1.2)\n```\n\nThe steps pattern in weekdays have a peak at the morning, and then the activity \nreduced to a relatively low level along the daytime. While in weeks the steps keeps\non a relatively high level along the daytime. On weekends people have their own time\nand may walk or do same movements on their own schedule, which could leads to the\ndifferent patterns between weekdays and weekends.\n\n\n",
    "created" : 1439554475867.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3147361212",
    "id" : "CAC50FED",
    "lastKnownWriteTime" : 1439561844,
    "path" : "E:/Coding/DataScience/R/RepData_PeerAssessment1/PA1_template.Rmd",
    "project_path" : "PA1_template.Rmd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}